# Cyber Prayer 赛博转经筒

## 数据介绍

本项目使用的佛经来自[CBeta项目](https://cbeta.org/ebooks)：``https://cbeta.org/ebooks``，佛经部分内容按照**CC BY-NC-SA 3.0 TW**协议授权使用，援引项目资料，共包括如下佛经：

```TEXT
CBETA 電子佛典資料庫 (以下簡稱本資料庫) 之底本為：
《大正新脩大藏經》（大藏出版株式會社 ©） 第一冊至第八十五冊
《卍新纂續藏經》（株式會社國書刊行會 ©）第一冊至第九十冊

歷代藏經補輯
《嘉興大藏經》（新文豐出版公司）第一冊至第四十冊
《房山石經》、《趙城金藏》、《永樂北藏》等等
「國家圖書館善本佛典」（國家圖書館 ©）
《漢譯南傳大藏經》（元亨寺 ©）第一冊至第七十冊

近代新編文獻
《藏外佛教文獻》（方廣錩 ©）第一輯至第十二輯
《正史佛教資料類編》（杜斗城 ©）
《北朝佛教石刻拓片百品》（中央研究院歷史語言研究所 ©）
《大藏經補編》（藍吉富 ©）第一冊至第三十六冊
《中國佛寺史志彙刊》（杜潔祥主編，「中國佛教寺廟志數位典藏」專案提供數位版本）
《中國佛寺志叢刊》（張智等編輯，「中國佛教寺廟志數位典藏」專案提供數位版本）
《印順法師佛學著作集》（印順文教基金會 ©）
《呂澂佛學著作集》（呂應中等 ©）
《太虛大師全書》（印順文教基金會 ©）
```

共包括21956个文件（文件列表见``ret/index.csv``），其统计数据如下：

- 总行数: 4,014,808
- 总字符数: 269,951,447
- 中文字数: 222,435,739
- 标点符号数: 40,749,468
- 空格/换行数: 5,774,531

使用``analyze_sutra.py``统计排名前1000的词语的词频，文件保存在``ret/word_freq.csv``，前20名如下

```csv
排名,词语,出现次数
1,是,1648566
2,也,1399646
3,於,1215085
4,「,1107209
5,有,1059263
6,為,1042139
7,」,984763
8,之,973822
9,說,780206
10,故,751449
11,不,737357
12,而,714547
13,曰,646612
14,無,636507
15,等,625397
16,一切,623732
17,亦,576997
18,者,535438
19,我,528949
20,即,502587
```

## 运行结果

结果上，我的家用PC稳定速度在20GB/s附近，相当于每秒抄289亿字（285万部）的经文，每天就是24969600亿字，按照我爱发明的惯例，我们对比一下人工队。人工队由全世界82亿人民共同参与，假设大家7*24小时的抄写，每分钟抄60个字（当然，在繁体中文的情况下，这几乎是个不可能的速度），相当于每秒82亿字，机器队达到了人工队速度的3.5倍！（雾

其实这个速度感觉还是受限了，得在Linux上开tmpfs跑着看看。以后有时间再吧（

测试环境：

```
处理器	13th Gen Intel(R) Core(TM) i7-13700KF (3.40 GHz)
机带 RAM	64.0 GB (63.8 GB 可用) DDR4 3600MT/s

版本	Windows 11 专业版
版本号	24H2
安装日期	2025/8/19
操作系统版本	26100.7462
体验	Windows 功能体验包 1000.26100.275.0
```

参数：

```json
{
  "source_file": "sum_gbk.zpaq",
  "target_dir": "R:/",
  "target_filename": "speed_test_pool.dat",
  "threads": 12,
  "pool_size_gb": 16,
  "stats_interval_sec": 5
}
```

输出：

```txt
=== RAM Disk Speed Test (Config Mode) ===
Python Ver : 3.13.9 [DISABLED (Free-Threaded)]
配置文件   : config.json
源文件     : sum_gbk.zpaq
目标地     : R:/speed_test_pool.dat
线程数     : 12
池大小     : 16 GB
============================================
[-] 正在加载源文件到内存...
[-] 源文件大小: 162.62 MB
[-] 正在预分配 16 GB 空间...
[-] 启动测试引擎 (统计间隔: 5s)...

测试正在运行。按 Ctrl+C 平滑停止（完成当前写入后再停止）。

Time       | Speed (GB/s)   | IOPS (iter/s)   | Total Writes   | Total Data (GB)
--------------------------------------------------------------------------------
06:35:49   | 8.73           | 55.0            | 275            | 43.67          
06:35:54   | 13.36          | 84.1            | 696            | 110.53         
06:35:59   | 13.72          | 86.4            | 1,128          | 179.14         
06:36:04   | 3.72           | 23.4            | 1,245          | 197.72         
06:36:09   | 14.51          | 91.4            | 1,702          | 270.30         
06:36:14   | 19.47          | 122.6           | 2,315          | 367.65         
06:36:19   | 18.86          | 118.8           | 2,909          | 461.99         
06:36:24   | 18.32          | 115.4           | 3,486          | 553.62         
06:36:29   | 17.97          | 113.1           | 4,052          | 643.51         
06:36:34   | 18.86          | 118.8           | 4,646          | 737.85         
06:36:39   | 18.93          | 119.2           | 5,242          | 832.50         
06:36:44   | 18.86          | 118.8           | 5,836          | 926.83         
06:36:49   | 19.85          | 125.0           | 6,461          | 1026.09        
06:36:54   | 19.47          | 122.6           | 7,074          | 1123.44        
06:36:59   | 20.55          | 129.4           | 7,721          | 1226.20        
06:37:04   | 20.51          | 129.2           | 8,367          | 1328.79        
06:37:09   | 19.59          | 123.4           | 8,984          | 1426.78        
06:37:14   | 20.70          | 130.4           | 9,636          | 1530.32        


[*] 接收到停止信号 (Ctrl+C)...
[*] 等待所有线程完成当前写入操作 (Graceful Shutdown)...

==================================================
              测试结果汇总
==================================================
运行时间     : 91.56 秒
总写入次数   : 9,840 次 (完整文件)
总写入数据   : 1562.72 GB
平均速度     : 17.07 GB/s
平均 IOPS    : 107.5 iter/s
==================================================
[-] 资源已释放，程序退出。
```



## 完整复现步骤

### 环境准备

你的电脑上应有：

- uv，或其他合适的python包管理软件
- PeaZip，或其他你喜欢的压缩软件，使用PeaZip是因为他的GUI比较好看

### 数据清洗与合并

下载txt版的完整经文文件（[CBeta](https://cbeta.org/ebooks))，将压缩包解压到``./database``文件夹。我使用的版本是``CBETA 2025 R3 TXT 電子書 不含校注``。原版使用utf8编码，unicode里一个汉字占3-4字节，GBK只占2-4字节，且大概率为2，因此，建议使用**GBK**编码以达到最佳文件体积优化效果，经验证，对于上述版本的数据集，不同编码处理后的txt文件大小如下：

- utf8编码文件大小：799,853,773 字节，``SHA256: f4da5e7cee945de8b36d1fce412e64c5d803b69b8cac77b6679e3d3f99dbe09a``
- gbk编码文件大小：536,314,463 字节，``SHA256: e3a5f2830b3ca547815d5e5af73e2f1e6952abc6ce76d6ae2359caecf9186d5e``
- gb18030编码文件大小：537,704,719 字节,``SHA256: a09af2b254ffa164ba4bf1aedb5d7fb14345845a2bc499da0a41a3835ef7d59b``

处理后，直接打开合并后的文件很有可能是乱码，如果出现这种情况，请注意更改你文本编辑器中的读取格式到GBK。

如果你的操作和我一模一样，理应得到SHA256相同的文件。

### 文件压缩

为了平衡压缩率和压缩速度，我最终使用了ZPAQ格式，注意选method 5以达到最佳效果（在PeaZip中，这个选项叫“最佳”）。这个过程可能占用8-10G的内存，请确保你有足够的内存进行操作。

文件压缩后，大小为170,524,147 字节，``SHA256: e1e778d3067358989a1c29783729f42e32f12045e6759685730e586ac8bcd6ba``
